[2026-01-13 17:16:16,582][absl][ERROR] - [process=0][thread=array_type_handler][operation_id=1] _SignalingThread.run() raised an exception: Checkpoint path should be absolute. Got checkpoints/components/ippo/checkpoint_10.orbax-checkpoint-tmp
Traceback (most recent call last):
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 312, in run
    super().run()
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 257, in _target_setting_result
    self._result = target()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 391, in <lambda>
    target=lambda: asyncio_utils.run_sync(coro),
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/asyncio_utils.py", line 36, in run_sync
    return asyncio.run(coro)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/jax_array_handlers.py", line 373, in _serialize_without_dispatcher
    await async_serialize_replica_slices_batch(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/jax_array_handlers.py", line 570, in _async_serialize_replica_slices
    array_write_spec = ts_utils.build_array_write_spec(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/tensorstore_utils.py", line 759, in build_array_write_spec
    return ArrayWriteSpec(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/tensorstore_utils.py", line 458, in __init__
    kvstore_tspec = build_kvstore_tspec(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/tensorstore_utils.py", line 170, in build_kvstore_tspec
    raise ValueError(f'Checkpoint path should be absolute. Got {directory}')
ValueError: Checkpoint path should be absolute. Got checkpoints/components/ippo/checkpoint_10.orbax-checkpoint-tmp
[2026-01-13 17:16:16,619][absl][ERROR] - [process=0][thread=write_metadata_after_commits][operation_id=1] _SignalingThread.run() raised an exception: Checkpoint path should be absolute. Got checkpoints/components/ippo/checkpoint_10.orbax-checkpoint-tmp
Traceback (most recent call last):
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 312, in run
    super().run()
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 257, in _target_setting_result
    self._result = target()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 391, in <lambda>
    target=lambda: asyncio_utils.run_sync(coro),
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/asyncio_utils.py", line 36, in run_sync
    return asyncio.run(coro)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 1198, in _write_metadata_after_commits
    await asyncio.to_thread(commit_future.result)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 449, in result
    return self._f.result(timeout=timeout)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 398, in result
    return self._t.result(timeout=timeout)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 347, in result
    self.join(timeout=timeout)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 344, in join
    raise self._exception
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 312, in run
    super().run()
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 257, in _target_setting_result
    self._result = target()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 391, in <lambda>
    target=lambda: asyncio_utils.run_sync(coro),
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/asyncio_utils.py", line 36, in run_sync
    return asyncio.run(coro)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/jax_array_handlers.py", line 373, in _serialize_without_dispatcher
    await async_serialize_replica_slices_batch(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/jax_array_handlers.py", line 570, in _async_serialize_replica_slices
    array_write_spec = ts_utils.build_array_write_spec(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/tensorstore_utils.py", line 759, in build_array_write_spec
    return ArrayWriteSpec(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/tensorstore_utils.py", line 458, in __init__
    kvstore_tspec = build_kvstore_tspec(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/tensorstore_utils.py", line 170, in build_kvstore_tspec
    raise ValueError(f'Checkpoint path should be absolute. Got {directory}')
ValueError: Checkpoint path should be absolute. Got checkpoints/components/ippo/checkpoint_10.orbax-checkpoint-tmp
[2026-01-13 17:16:16,624][jax._src.debugging][ERROR] - jax.debug.callback failed
Traceback (most recent call last):
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/jax/_src/debugging.py", line 96, in debug_callback_impl
    callback(*args)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/jax/_src/debugging.py", line 336, in _flat_callback
    callback(*args, **kwargs)
  File "/home/romanohu/project/wkb/SocialJax/components/algorithms/ippo.py", line 317, in _save_callback
    save_checkpoint(ckpt_dir, int(step), {"params": params}, keep=ckpt_keep)
  File "/home/romanohu/project/wkb/SocialJax/components/training/checkpoint.py", line 12, in save_checkpoint
    checkpoints.save_checkpoint(ckpt_dir, payload, step, keep=keep, overwrite=True)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/flax/training/checkpoints.py", line 693, in save_checkpoint
    orbax_checkpointer.save(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/checkpointers/checkpointer.py", line 259, in save
    self._handler.save(tmpdir.get(), args=ckpt_args)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/handlers/pytree_checkpoint_handler.py", line 666, in save
    self._handler_impl.save(directory, args=args)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 764, in save
    asyncio_utils.run_sync(async_save(directory, *args, **kwargs))
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/asyncio_utils.py", line 36, in run_sync
    return asyncio.run(coro)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 762, in async_save
    f.result()  # Block on result.
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 196, in result
    f.result(timeout=time_remaining)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 449, in result
    return self._f.result(timeout=timeout)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 398, in result
    return self._t.result(timeout=timeout)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 347, in result
    self.join(timeout=timeout)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 344, in join
    raise self._exception
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 312, in run
    super().run()
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 257, in _target_setting_result
    self._result = target()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 391, in <lambda>
    target=lambda: asyncio_utils.run_sync(coro),
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/asyncio_utils.py", line 36, in run_sync
    return asyncio.run(coro)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/handlers/base_pytree_checkpoint_handler.py", line 1198, in _write_metadata_after_commits
    await asyncio.to_thread(commit_future.result)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 449, in result
    return self._f.result(timeout=timeout)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 398, in result
    return self._t.result(timeout=timeout)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 347, in result
    self.join(timeout=timeout)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 344, in join
    raise self._exception
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 312, in run
    super().run()
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 257, in _target_setting_result
    self._result = target()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/futures/future.py", line 391, in <lambda>
    target=lambda: asyncio_utils.run_sync(coro),
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/asyncio_utils.py", line 36, in run_sync
    return asyncio.run(coro)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/home/romanohu/.local/share/uv/python/cpython-3.10.19-linux-x86_64-gnu/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/jax_array_handlers.py", line 373, in _serialize_without_dispatcher
    await async_serialize_replica_slices_batch(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/jax_array_handlers.py", line 570, in _async_serialize_replica_slices
    array_write_spec = ts_utils.build_array_write_spec(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/tensorstore_utils.py", line 759, in build_array_write_spec
    return ArrayWriteSpec(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/tensorstore_utils.py", line 458, in __init__
    kvstore_tspec = build_kvstore_tspec(
  File "/home/romanohu/project/wkb/SocialJax/.venv/lib/python3.10/site-packages/orbax/checkpoint/_src/serialization/tensorstore_utils.py", line 170, in build_kvstore_tspec
    raise ValueError(f'Checkpoint path should be absolute. Got {directory}')
ValueError: Checkpoint path should be absolute. Got checkpoints/components/ippo/checkpoint_10.orbax-checkpoint-tmp
[2026-01-13 19:21:40,634][absl][INFO] - Saving checkpoint at step: 10
[2026-01-13 19:21:40,635][absl][INFO] - Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
[2026-01-13 19:21:40,635][absl][INFO] - save_device_host_concurrent_bytes=None
[2026-01-13 19:21:40,635][absl][INFO] - Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x7b84bc5dc2e0>, enable_pinned_host_transfer=True, save_concurrent_bytes: 96000000000 (89.4 GiB), restore_concurrent_bytes: 96000000000 (89.4 GiB)
[2026-01-13 19:21:40,635][absl][INFO] - orbax-checkpoint version: 0.11.31
[2026-01-13 19:21:40,635][absl][INFO] - [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID.
[2026-01-13 19:21:40,635][absl][INFO] - [process=0] Started saving checkpoint to /home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10.
[2026-01-13 19:21:40,638][absl][INFO] - Creating tmp directory /home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10.orbax-checkpoint-tmp
[2026-01-13 19:21:40,641][absl][INFO] - Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768299700640599219, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1768299700640599219, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2026-01-13 19:21:40,648][absl][INFO] - Using ThreadSafeKeyValueSignalingClient
[2026-01-13 19:21:40,649][absl][INFO] - Scheduling D2H of 16 prioritized jax.Array.
[2026-01-13 19:21:40,649][absl][INFO] - Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
[2026-01-13 19:21:40,654][absl][INFO] - [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.005850s
[2026-01-13 19:21:40,655][absl][INFO] - [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 103.657 MiB/s (total gbytes: 1.1 MiB) (time elapsed: 10 milliseconds) (per-host)
[2026-01-13 19:21:40,656][absl][INFO] - [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.011612s (batch_requests_ready=0.002108s, total_serialization_initiated=0.007400s, others=0.002104s)
[2026-01-13 19:21:40,656][absl][INFO] - [process=0][thread=MainThread][operation_id=1] _SignalingThread.join() waiting for signals ([]) blocking the main thread will slow down blocking save times. This is likely due to main thread calling result() on a CommitFuture.
[2026-01-13 19:21:40,658][absl][INFO] - [process=0][thread=array_type_handler] Wrote 16 array_metadata.ArrayMetadata to /home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10.orbax-checkpoint-tmp/array_metadatas/process_0
[2026-01-13 19:21:40,771][absl][INFO] - [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 0.088717s (commit=0.083312s, array_metadata_write=0.005405s)
[2026-01-13 19:21:40,773][absl][INFO] - [process=0] /jax/checkpoint/write/gbytes_per_sec: 8.624 MiB/s (total gbytes: 1.1 MiB) (time elapsed: 128 milliseconds) (per-host)
[2026-01-13 19:21:40,775][absl][INFO] - Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768299700640599219, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2026-01-13 19:21:40,776][absl][INFO] - Updated Metadata={'item_handlers': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler', 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768299700640599219, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2026-01-13 19:21:40,778][absl][INFO] - [process=0][thread=MainThread] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
[2026-01-13 19:21:40,788][absl][INFO] - [process=0][thread=MainThread] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.012023s. use_zarr3=False, enable_post_merge_validation=True, directory=/home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10.orbax-checkpoint-tmp
[2026-01-13 19:21:40,789][absl][INFO] - Renaming /home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10.orbax-checkpoint-tmp to /home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10
[2026-01-13 19:21:40,790][absl][INFO] - [process=0][thread=MainThread] Finished saving checkpoint (finalized tmp dir) to `/home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10`.
[2026-01-13 19:21:40,791][absl][INFO] - Finished synchronous save in 0.16 seconds to /home/romanohu/project/wkb/SocialJax/runs/2026-01-13_19-20-31/checkpoints/svo/checkpoint_10
[2026-01-14 06:35:40,925][absl][INFO] - Saving checkpoint at step: 10
[2026-01-14 06:35:40,927][absl][INFO] - Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
[2026-01-14 06:35:40,927][absl][INFO] - save_device_host_concurrent_bytes=None
[2026-01-14 06:35:40,927][absl][INFO] - Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x7c9ad47ac370>, enable_pinned_host_transfer=True, save_concurrent_bytes: 96000000000 (89.4 GiB), restore_concurrent_bytes: 96000000000 (89.4 GiB)
[2026-01-14 06:35:40,927][absl][INFO] - orbax-checkpoint version: 0.11.31
[2026-01-14 06:35:40,927][absl][INFO] - [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID.
[2026-01-14 06:35:40,927][absl][INFO] - [process=0] Started saving checkpoint to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10.
[2026-01-14 06:35:40,930][absl][INFO] - Creating tmp directory /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp
[2026-01-14 06:35:40,933][absl][INFO] - Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768340140932927535, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1768340140932927535, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2026-01-14 06:35:40,940][absl][INFO] - Using ThreadSafeKeyValueSignalingClient
[2026-01-14 06:35:40,941][absl][INFO] - Scheduling D2H of 16 prioritized jax.Array.
[2026-01-14 06:35:40,941][absl][INFO] - Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
[2026-01-14 06:35:41,052][absl][INFO] - [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.112014s
[2026-01-14 06:35:41,056][absl][INFO] - [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 9.225 MiB/s (total gbytes: 1.1 MiB) (time elapsed: 120 milliseconds) (per-host)
[2026-01-14 06:35:41,058][absl][INFO] - [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.122123s (batch_requests_ready=0.002481s, total_serialization_initiated=0.116436s, others=0.003206s)
[2026-01-14 06:35:41,060][absl][INFO] - [process=0][thread=MainThread][operation_id=1] _SignalingThread.join() waiting for signals ([]) blocking the main thread will slow down blocking save times. This is likely due to main thread calling result() on a CommitFuture.
[2026-01-14 06:35:41,062][absl][INFO] - [process=0][thread=array_type_handler] Wrote 16 array_metadata.ArrayMetadata to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp/array_metadatas/process_0
[2026-01-14 06:35:41,176][absl][INFO] - [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 0.115694s (commit=0.110481s, array_metadata_write=0.005213s)
[2026-01-14 06:35:41,178][absl][INFO] - [process=0] /jax/checkpoint/write/gbytes_per_sec: 4.571 MiB/s (total gbytes: 1.1 MiB) (time elapsed: 242 milliseconds) (per-host)
[2026-01-14 06:35:41,181][absl][INFO] - Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768340140932927535, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2026-01-14 06:35:41,181][absl][INFO] - Updated Metadata={'item_handlers': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler', 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768340140932927535, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2026-01-14 06:35:41,184][absl][INFO] - [process=0][thread=MainThread] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
[2026-01-14 06:35:41,205][absl][INFO] - [process=0][thread=MainThread] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.022995s. use_zarr3=False, enable_post_merge_validation=True, directory=/home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp
[2026-01-14 06:35:41,208][absl][INFO] - Renaming /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10
[2026-01-14 06:35:41,212][absl][INFO] - [process=0][thread=MainThread] Finished saving checkpoint (finalized tmp dir) to `/home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10`.
[2026-01-14 06:35:41,214][absl][INFO] - Finished synchronous save in 0.29 seconds to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_06-34-47/checkpoints/ippo/checkpoint_10
[2026-01-14 07:17:24,162][absl][INFO] - Saving checkpoint at step: 10
[2026-01-14 07:17:24,163][absl][INFO] - Using Orbax as backend to save Flax checkpoints. For potential troubleshooting see: https://flax.readthedocs.io/en/latest/guides/training_techniques/use_checkpointing.html#orbax-as-backend-troubleshooting
[2026-01-14 07:17:24,163][absl][INFO] - save_device_host_concurrent_bytes=None
[2026-01-14 07:17:24,164][absl][INFO] - Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x770468f3c1f0>, enable_pinned_host_transfer=True, save_concurrent_bytes: 96000000000 (89.4 GiB), restore_concurrent_bytes: 96000000000 (89.4 GiB)
[2026-01-14 07:17:24,164][absl][INFO] - orbax-checkpoint version: 0.11.31
[2026-01-14 07:17:24,164][absl][INFO] - [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID.
[2026-01-14 07:17:24,164][absl][INFO] - [process=0] Started saving checkpoint to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10.
[2026-01-14 07:17:24,166][absl][INFO] - Creating tmp directory /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp
[2026-01-14 07:17:24,169][absl][INFO] - Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768342644168496114, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1768342644168496114, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2026-01-14 07:17:24,187][absl][INFO] - Using ThreadSafeKeyValueSignalingClient
[2026-01-14 07:17:24,208][absl][INFO] - Scheduling D2H of 112 prioritized jax.Array.
[2026-01-14 07:17:24,208][absl][INFO] - Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
[2026-01-14 07:17:24,232][absl][INFO] - [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 0.045094s
[2026-01-14 07:17:24,305][absl][INFO] - [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 58.175 MiB/s (total gbytes: 7.8 MiB) (time elapsed: 133 milliseconds) (per-host)
[2026-01-14 07:17:24,308][absl][INFO] - [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 0.136415s (batch_requests_ready=0.007363s, total_serialization_initiated=0.124363s, others=0.004689s)
[2026-01-14 07:17:24,312][absl][INFO] - [process=0][thread=MainThread][operation_id=1] _SignalingThread.join() waiting for signals ([]) blocking the main thread will slow down blocking save times. This is likely due to main thread calling result() on a CommitFuture.
[2026-01-14 07:17:24,313][absl][INFO] - [process=0][thread=array_type_handler] Wrote 112 array_metadata.ArrayMetadata to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp/array_metadatas/process_0
[2026-01-14 07:17:24,611][absl][INFO] - [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 0.306253s (commit=0.297230s, array_metadata_write=0.009023s)
[2026-01-14 07:17:24,612][absl][INFO] - [process=0] /jax/checkpoint/write/gbytes_per_sec: 17.602 MiB/s (total gbytes: 7.8 MiB) (time elapsed: 440 milliseconds) (per-host)
[2026-01-14 07:17:24,615][absl][INFO] - Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768342644168496114, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2026-01-14 07:17:24,616][absl][INFO] - Updated Metadata={'item_handlers': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler', 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1768342644168496114, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2026-01-14 07:17:24,621][absl][INFO] - [process=0][thread=MainThread] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
[2026-01-14 07:17:24,640][absl][INFO] - [process=0][thread=MainThread] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.022786s. use_zarr3=False, enable_post_merge_validation=True, directory=/home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp
[2026-01-14 07:17:24,642][absl][INFO] - Renaming /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10.orbax-checkpoint-tmp to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10
[2026-01-14 07:17:24,645][absl][INFO] - [process=0][thread=MainThread] Finished saving checkpoint (finalized tmp dir) to `/home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10`.
[2026-01-14 07:17:24,647][absl][INFO] - Finished synchronous save in 0.48 seconds to /home/romanohu/project/wkb/SocialJax/runs/2026-01-14_07-16-25/checkpoints/ippo/checkpoint_10
